=head2 stereogram

=for ref

Given a "raw iquv" vector generated by read_iquv, and a column vector for calibration,
return a calibrated stereogram...

=cut

sub stereogram {
    my $a = shift;
    my $b = shift;
    my $vec = shift;
    $vec = pdl(0,1,0,0) unless defined($vec);
    
    my $aa = $a->mv(3,0);
    my $bb = $b->mv(3,0)->(:,:,:,pdl(1,0,3,2));

    return ( ($vec * ($aa+$bb))->sumover );
}
